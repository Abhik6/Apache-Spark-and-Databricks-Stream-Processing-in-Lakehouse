Welcome back.

In this lecture, we will write code to automate our batch mode integration testing.

So let's start.

Go to the development environment.

Go to Workspace, Repos and choose your SBIT repository.

Now, you can add a new notebook here.

Rename the notebook.

We are now ready to code.

Let's start with defining our environment variable.

Good.

So this notebook takes an environment name so we can run it in any environment.

The default value is the dev environment.

To test our application workflows, we must run the setup.

So, let me import the setup notebook.

Then, I can create a setup object and also run cleanup once.

Cleaning up our environment before testing is essential.

So, I am running the cleanup method once.

What is next?

I can trigger the run notebook.

Let run it.

The run notebook will trigger a batch for the first time.

It will execute the setup and history loader.

However, we do not have any data in the landing zone, so the first batch will not produce any output.

Correct?

However, the setup and history load must have been completed.

So, let me import the history loader and validate the history load.

Import the history loader notebook.

Now, we can validate it.

Great!

So, we are done loading and validating historical data.

What is next?

Simple!

Produce the first set of data and run the next batch.

Correct?

Let me import the producer.

Now, I can produce the data and run the next batch.

Done.

At this stage, we must have processed all the bronze, silver, and gold layer tables.

What is next?

We must validate the results.

So, let me import a bronze notebook.

Import the silver notebook.

Finally, import the gold notebook.

Now, we can write validation code.

So, we are validating the bronze layer for the first payload.

Similarly, we are validating silver and gold layers.

If this validation passes, we must produce the second payload and run the next batch.

That's all.

Finally, we can validate the second payload.

I am also doing a cleanup at the end.

If all this runs without any error, we are done testing our entire pipeline in batch mode.

And that is all about developing an integration test for your application.

See you in the following lecture.

Keep learning and Keep growing.
