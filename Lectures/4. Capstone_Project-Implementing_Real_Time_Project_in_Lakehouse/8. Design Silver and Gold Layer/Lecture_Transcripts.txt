Welcome Back.

We designed a bronze layer for our lakehouse.

Here it is.

Now let's move further to create the silver layer and complete the second layer of the medallion architecture.

The initial portion of the silver layer design is straightforward.

Let me show you.

Here it is.

We want to create five entity tables in the silver layer.

Why five?

Because we have five entities in our requirements.

Users

Gym Logs

User Profile

Heart Rate

and Workouts

One of the most straightforward designs is one silver layer table for each entity.

We want to create one high-quality entity data set for all our entities in the silver layer.

And that's what we are doing here.

Simple!

Isn't it?

Now we also need to create five Spark jobs to fill these tables.

But these Spark jobs should apply quality checks on the raw data,

eliminate duplicates, and handle the CDC scenario.

What does it mean?

Our silver layer entity tables must have a good quality data set we can trust.

We shouldn't have duplicate records in the silver layer.

If we receive change data, we must handle it appropriately in the silver layer.

So creating these five silver-layer jobs is complex compared to bronze-layer jobs.

Correct!

That's fine.

We will come to the job implementation in the coming lectures.

Let's look at the gold layer.

Our requirement is simple, and we are expected to produce two reporting data sets.

Let me add those two to the gold layer.

Great!

We have a simple requirement for a gold layer.

All we need is two flat reporting tables.

So I added them here.

But in other projects, you may have a requirement to design a data model such as Star Schema data mart.

Your gold layer could be full of data marts, and you may have to apply your data modeling skills in this area.

But for us, we have a simple flat data model, and all we need are two reporting tables.

Great!

So far, everything is super simple.

We created bronze layer raw data tables

and silver layer entry tables, and we also know what gold layer tables are needed.

Now we need to think about how we compute these two reports.

I mean, we have entity tables, and we also know our reporting tables.

But how do we transform data from the entity tables to the reporting tables?

That's where all your data engineering skills are required.

I have done that exercise.

And here is the data flow.

I realized that we also need to create some intermediate silver layer tables to calculate these two reports.

We need to bucket users in age groups, and hence we create the user bins table.

We also want to match the workout start and end to create completed workouts.

And then, we combine completed workouts with the heart rate to create workout bpm.

We can quickly compute the reporting tables once we have these three intermediate silver tables.

And this is all.

Now we have a complete medallion architecture and a data flow design.

And that's all for this lecture.

See you again in the following lecture, and we will start talking about the implementation strategy.

Keep Learning and Keep Growing.
